# ─────────────────────────────────────────────────────────────────────────────
# Domus Semper Palingenesis - Unified Manifest
# The ever-regenerating home: tracks state, auto-organizes, heals drift
# ─────────────────────────────────────────────────────────────────────────────

schema_version: 2

# ─────────────────────────────────────────────────────────────────────────────
# Package Management
# ─────────────────────────────────────────────────────────────────────────────

packages:
  homebrew:
    formulae:
      # Core tools
      - chezmoi
      - git
      - gh
      - neovim
      - fzf
      - fd
      - ripgrep
      - bat
      - eza
      - zoxide
      - starship
      - atuin
      - direnv
      - mise
      # Development
      - jq
      - yq
      - just
      - lazygit
      - lazydocker
      - git-delta
      - git-absorb
      - git-filter-repo
      - git-gui
      - git-secrets
      - golangci-lint
      - llvm
      - nasm
      - opencode
      - procs
      # Development environments
      - go
      - rust
      - ruby
      - node
      - uv
      - pre-commit
      - python@3.11
      - python@3.13
      - python@3.14
      # DevOps & containers
      - act
      - k9s
      - qemu
      # AI tools
      - block-goose-cli
      - gemini-cli
      - huggingface-cli
      - kimi-cli
      # Security & code quality
      - actionlint
      - gitleaks
      - ggshield
      - trivy
      - gnupg
      - git-lfs
      - shellcheck
      - shfmt
      # Media & files
      - ffmpeg
      - rclone
      - qpdf
      - pillow
      - poppler
      - tesseract
      # Shell & terminal
      - bash
      - zsh
      - zsh-autosuggestions
      - zsh-completions
      - zsh-syntax-highlighting
      - fish
      - tmux
      - byobu
      - thefuck
      - carapace
      # Extras
      - bats-core
      - btop
      - coreutils
      - dropbox-uploader
      - duf
      - entr
      - fileicon
      - flavours
      - fresh-editor
      - fswatch
      - glow
      - gron
      - htop
      - hyperfine
      - lolcat
      - markdown
      - micro
      - navi
      - ncdu
      - pipx
      - progress
      - pv
      - tlrc
      # Libraries & dependencies (auto-installed)
      - ada-url
      - aom
      - autoconf
      - automake
      - brotli
      - c-ares
      - ca-certificates
      - cairo
      - capstone
      - certifi
      - cffi
      - cryptography
      - dav1d
      - dtc
      - file-formula
      - fmt
      - fontconfig
      - form
      - freetype
      - fribidi
      - gettext
      - giflib
      - glib
      - gmp
      - gnutls
      - gpgme
      - gpgmepp
      - graphite2
      - harfbuzz
      - hdrhistogram_c
      - highway
      - icu4c@78
      - imath
      - jpeg-turbo
      - jpeg-xl
      - lame
      - leptonica
      - libarchive
      - libassuan
      - libavif
      - libb2
      - libdatrie
      - libdeflate
      - libevent
      - libgcrypt
      - libgit2
      - libgpg-error
      - libidn2
      - libimagequant
      - libksba
      - libmagic
      - libnghttp2
      - libnghttp3
      - libngtcp2
      - libpng
      - libraqm
      - libslirp
      - libssh
      - libssh2
      - libtasn1
      - libthai
      - libtiff
      - libtommath
      - libunistring
      - libusb
      - libuv
      - libvmaf
      - libvpx
      - libx11
      - libxau
      - libxcb
      - libxdmcp
      - libxext
      - libxrender
      - libyaml
      - little-cms2
      - llhttp
      - lpeg
      - luajit
      - luv
      - lz4
      - lzo
      - m4
      - mpdecimal
      - mpfr
      - ncurses
      - nettle
      - newt
      - npth
      - nspr
      - nss
      - oniguruma
      - openexr
      - openjpeg
      - openjph
      - openssl@3
      - opus
      - p11-kit
      - pango
      - pcre2
      - pinentry
      - pixman
      - pkgconf
      - popt
      - pycparser
      - pydantic
      - readline
      - rpds-py
      - s-lang
      - sdl2
      - simdjson
      - snappy
      - sqlite
      - svt-av1
      - tcl-tk
      - tree-sitter@0.25
      - unbound
      - unibilium
      - usage
      - utf8proc
      - uvwasi
      - vde
      - webp
      - x264
      - x265
      - xorgproto
      - xz
      - z3
      - zstd
    casks:
      - kitty
      - 1password-cli
      - visual-studio-code
      - visual-studio-code@insiders
      - warp
      - claude-code
      - codex
      - gcloud-cli
      - gitkraken-cli
      - block-goose
      - klatexformula
      - mailmate
      - ngrok
      - plugdata
      - font-jetbrains-mono-nerd-font

  pipx:
    - pywal
    - pplx-cli
    - jupyter-mcp-server

  npm_global:
    - pnpm
    - "@anthropic-ai/mcpb"
    - "@expo/ngrok"
    - "@google/gemini-cli"
    - "@trunkio/launcher"
    - "@github/copilot"
    - "@githubnext/github-copilot-cli"
    - "@modelcontextprotocol/server-github"
    - localtunnel
    - "@google/jules"

  cargo: []

  vscode:
    - continue.continue
    - saoudrizwan.claude-dev  # Cline

# ─────────────────────────────────────────────────────────────────────────────
# File Sorting Rules
# ─────────────────────────────────────────────────────────────────────────────

sorting:
  directories:
    - ~/Downloads
    - ~/Desktop

  rules:
    # Screenshots from Desktop
    - name: screenshots
      match:
        pattern: "Screenshot*.png"
        location: ~/Desktop
      action:
        move_to: "~/Pictures/Screenshots/{year}/{month}/"

    # PDFs anywhere
    - name: pdfs
      match:
        extension: [pdf]
      action:
        move_to: "~/Documents/PDFs/{year}/"
        rename: "{smart_name}"

    # DMG installers
    - name: installers
      match:
        extension: [dmg, pkg]
      action:
        move_to: "~/Downloads/_Installers/"

    # Archives
    - name: archives
      match:
        extension: [zip, tar, gz, 7z, rar]
      action:
        move_to: "~/Downloads/_Archives/{year}/"

    # Images
    - name: images
      match:
        extension: [jpg, jpeg, png, gif, webp, heic]
        location: ~/Downloads
      action:
        move_to: "~/Pictures/Downloads/{year}/{month}/"

    # Old downloads (archive after 30 days)
    - name: old-downloads
      match:
        age_days_min: 30
        location: ~/Downloads
        exclude_pattern: "^_"
      action:
        move_to: "~/Downloads/_Archive/{year}/"

# ─────────────────────────────────────────────────────────────────────────────
# Performance Budgets
# ─────────────────────────────────────────────────────────────────────────────

performance:
  shell_startup:
    target_ms: 400
    warning_ms: 700
    critical_ms: 1000

  daemon_run:
    target_ms: 5000
    warning_ms: 15000
    critical_ms: 60000

# ─────────────────────────────────────────────────────────────────────────────
# Notification Settings
# ─────────────────────────────────────────────────────────────────────────────

notifications:
  levels:
    silent:
      - sorting.file_moved
      - health.check_passed
      - packages.check_passed
    quiet:
      - sorting.rule_matched: 10  # Batch after 10 events
      - packages.minor_drift
    normal:
      - packages.update_available
      - sorting.error
      - health.drift_detected
    urgent:
      - health.critical_failure
      - packages.major_drift

  quiet_hours:
    start: "22:00"
    end: "08:00"

  batch_delay_seconds: 30
