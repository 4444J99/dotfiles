# ─────────────────────────────────────────────────────────────────────────────
# Git Configuration - Managed by Chezmoi
# ─────────────────────────────────────────────────────────────────────────────

[user]
	email = {{ .email }}
	name = {{ .name }}
{{- if .ssh_signing_key }}
	signingkey = {{ .ssh_signing_key }}
{{- end }}

[commit]
	gpgsign = true

[tag]
	gpgsign = true

[gpg]
	format = ssh

[gpg "ssh"]
	program = "/Applications/1Password.app/Contents/MacOS/op-ssh-sign"
	allowedSignersFile = {{ .chezmoi.homeDir }}/.config/git/allowed_signers

[core]
	hooksPath = {{ .chezmoi.homeDir }}/.config/git/hooks
	excludesfile = {{ .chezmoi.homeDir }}/.config/git/ignore
	attributesfile = {{ .chezmoi.homeDir }}/.config/git/attributes
	editor = nvim
	pager = delta

[init]
	defaultBranch = main

[pull]
	rebase = true

[push]
	autoSetupRemote = true
	default = current

[fetch]
	prune = true

[rebase]
	autoStash = true

[merge]
	conflictstyle = diff3

[diff]
	colorMoved = default

# Delta pager - Tokyo Night theme
[delta]
	navigate = true
	side-by-side = false
	line-numbers = true
	syntax-theme = "Catppuccin Mocha"

	# Colors
	minus-style = syntax "#37222c"
	minus-emph-style = syntax "#713137"
	plus-style = syntax "#20303b"
	plus-emph-style = syntax "#2c5a66"

	# Line numbers
	line-numbers-minus-style = "#f7768e"
	line-numbers-plus-style = "#9ece6a"
	line-numbers-zero-style = "#3b4261"

	# Diff header
	file-style = "#7aa2f7" bold
	file-decoration-style = "#7aa2f7" ul
	hunk-header-style = "#bb9af7" italic
	hunk-header-decoration-style = "#3b4261" box

[interactive]
	diffFilter = delta --color-only

# ─────────────────────────────────────────────────────────────────────────────
# Aliases
# ─────────────────────────────────────────────────────────────────────────────

[alias]
	# Status and info
	s = status -sb
	ss = status

	# Branching
	co = checkout
	cb = checkout -b
	sw = switch
	swc = switch -c

	# Commits
	cm = commit -m
	ca = commit --amend
	can = commit --amend --no-edit

	# Add
	aa = add -A
	ap = add -p

	# Pull/Push
	pl = pull --rebase
	ps = push
	psf = push --force-with-lease
	psu = push -u origin HEAD

	# Stash
	st = stash
	stp = stash pop
	stl = stash list

	# Log views
	lg = log --oneline --graph --decorate -20
	lga = log --oneline --graph --decorate --all
	ll = log --pretty=format:'%C(yellow)%h%Creset %s %C(cyan)(%cr)%Creset %C(blue)<%an>%Creset' -20
	last = log -1 HEAD --stat

	# Diff
	df = diff
	dfs = diff --staged
	dfw = diff --word-diff

	# Branch management
	br = branch
	bra = branch -a
	brd = branch -d
	brD = branch -D

	# Reset
	unstage = reset HEAD --
	undo = reset --soft HEAD~1

	# Utility
	contributors = shortlog -sn
	aliases = config --get-regexp alias
	whoami = config user.email
	root = rev-parse --show-toplevel

	# Show current branch
	current = rev-parse --abbrev-ref HEAD

# ─────────────────────────────────────────────────────────────────────────────
# Safe Directories (external volumes)
# ─────────────────────────────────────────────────────────────────────────────

[safe]
	directory = /Volumes/4444-iivii
	directory = /Volumes/4444-iivii/ivi374forivi3ivi3/workspace
	directory = /Volumes/4444-iivii/ivi374forivi3ivi3

# ─────────────────────────────────────────────────────────────────────────────
# Git LFS
# ─────────────────────────────────────────────────────────────────────────────

[filter "lfs"]
	smudge = git-lfs smudge -- %f
	process = git-lfs filter-process
	required = true
	clean = git-lfs clean -- %f

# ─────────────────────────────────────────────────────────────────────────────
# GitHub
# ─────────────────────────────────────────────────────────────────────────────

[credential "https://github.com"]
	helper = !/opt/homebrew/bin/gh auth git-credential

[url "git@github.com:"]
	insteadOf = https://github.com/
